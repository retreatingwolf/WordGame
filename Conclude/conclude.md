# 都市浮生记

花了八天时间，跟着视频用c++完成了《都市浮生记》这个基于文字的游戏的半成品，游戏本身不涉及图片，所以可以不必考虑easyx图形库的使用，我可以更加专心于c++语言本身的实现。这个项目（我不知道这个配不配称为项目），属于那种自己刚好能看懂，刚好在能力范围的边界上的项目，里面有很多很多新鲜的概念和编程方法，这也是我一直希望得到的东西。学校里学编程语言，仅仅是专注于教我们如何使用这个工具，完全没有使用的机会，工具学的再熟，不用的话不久就全忘了。 在这个项目中，我第一次深刻体会到面向对象编程的意义。由于是疯了一样一遍看视频一遍照着写代码，很多地方没有深刻理解那样写的含义，现在要做一个代码的整理工作，包括逻辑的理顺，注释的重写，变量命名的规范。

首先是MVC模式，指的是Model，View，Control三个部分的代码互相独立，分工明确，模型层负责游戏中需要用到的各种数据的初始化和加载，显示层负责用好看的方式显示游戏数据，控制层负责调用数据层的数据以及显示层的方法，处理用户输入相关的操作，以及游戏内核。什么叫处处都是类，游戏模型可以抽象成类容易理解，控制器和视图也可以抽象成很多类。每一层的几个小类又可以合并起来抽象成一个中类，几个中类又可以合并为一个大类里综合考虑。单独看每个类，里面的代码都很容易理解，但是一旦合并起来，要综合考虑程序先干了啥后干了啥是很不容易的。

第二是单例设计模式，据说是最简单的设计模式，由于此项目不涉及多线程，采用了简单的懒汉式，即在类中定义私有静态指针指向自己，并提供一个公有的静态类进行初始化，这样做保证了该类在整个过程中只有一个示例（原因我还不大理解）。用起来很方便，也是我之前没有接触过的概念和方法，非常有趣。游戏中很多对象的确只能有一个示例。

第三是system函数的使用，终于明白这个函数的作用了，是提供一个借口，让我们可以调用cmd的命令，从而做到控制命令行窗口的大小背景颜色字体颜色等参数，这样一系列操作可以放在main函数中统一进行实现。但是main.cpp中的函数定义为什么都加了extern关键字？

第四是字符串拼接，终于理解了在c++中stream（流）的真正含义，之前有<iostream>标准输入输出流以及<fstream>文件流，这几天又知道了还有<sstream>字符串流，统一起来看，它们有很多共同点，举一反三的使用。在游戏制作中，字符串流用处很大。



## 游戏规则

见“游戏规则.docx”

## 改进方法

1. 是不是可以采用文件操作，提供一个选项，将游戏关键数据存到文件里，实现一个存档功能。
2. 目前的半成品游戏仅仅实现一个地铁站的功能，之后要把其他地图都开放了。
3. 目前的不同地铁站的黑市就是摆设，同一天进入相同的黑市会得到不同的结果，而每天是可以无限进入黑市的，着意味着可以刷钱，游戏性被破坏
4. 黑市的出售购买还存在问题，若黑市没有某个商品，无法出售该商品
5. 代码变量太多之后，命名出现混乱，要整治这个问题
6. 单例设计模式是不是会出现内存泄漏的现象？寻找解决方法
7. 游戏中的很多参数能不能放到同一个头文件中？

